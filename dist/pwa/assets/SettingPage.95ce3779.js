import{Q as x}from"./QSkeleton.01e1d850.js";import{Q as S}from"./QForm.550ba64a.js";import{u as j,r,j as k,d as I,m as U,n as C,p as i,z as s,q as t,a$ as m,C as Q,y as $,v as G,Q as N,aU as L,aP as u}from"./index.30dd2348.js";import{Q as q}from"./QSelect.68da1b0a.js";import{Q as R}from"./QSpinnerGears.3a9ff54e.js";import{Q as T}from"./QPage.b9e58bdc.js";import{u as M}from"./use-quasar.67b6ac9a.js";import{url as J}from"./axios.66ae61ea.js";import{u as V}from"./user-store.f67a660c.js";import{u as H}from"./address-store.62c72731.js";import"./QItem.2b7551f8.js";import"./QItemLabel.580fc480.js";import"./QMenu.19c3a5ff.js";import"./selection.64adb4fb.js";import"./rtl.276c3f1b.js";import"./format.b9446fb2.js";const O=s("hr",{class:"q-my-md"},null,-1),W={class:"row justify-center"},X={class:"col-md-3 col-xs-12 q-ma-md"},Y={class:"col-md-8 col-xs-12 q-ma-md"},Z={class:"col-12 q-ma-md"},ee=s("hr",{class:"q-my-md"},null,-1),ae={class:"row justify-center"},le={class:"col-md-3 col-xs-12 q-ma-md"},se=s("div",{class:"text-body1 text-bold"},"Foto profil",-1),oe=["src"],te=s("div",{class:"text-subtitle2 text-grey-7"},"JPG atau PNG tidak lebih besar dari 5 MB",-1),ie={class:"col-md-8 col-xs-12 q-ma-md"},de=s("div",{class:"text-body1 text-bold"},"Detail Akun",-1),ne={class:"row justify-center"},re={class:"col-md-5 col-xs-10 q-mx-md"},ue=s("label",{class:"small mb-1",for:"username"},"Username",-1),me={class:"col-md-5 col-xs-10 q-mx-md"},ce=s("label",{class:"small mb-1",for:"name"},"Nama",-1),ve={class:"col-md-5 col-xs-10 q-mx-md"},pe=s("label",{class:"small mb-1",for:"email"},"Email",-1),_e={class:"col-md-5 col-xs-10 q-mx-md"},fe=s("label",{class:"small mb-1",for:"phone_number"},"Nomor Telepon",-1),ge={class:"col-12 q-ma-md"},be=s("div",{class:"text-body1 text-bold"},"Alamat",-1),he={class:"row justify-center"},ye={class:"col-md-5 col-xs-10 q-my-sm q-mx-md"},xe=s("label",{class:"small mb-1",for:"province"},"Provinsi",-1),qe={class:"col-md-5 col-xs-10 q-my-sm q-mx-md"},Ve=s("label",{class:"small mb-1",for:"regency"},"Kabupaten",-1),we={class:"col-md-5 col-xs-10 q-my-sm q-mx-md"},ke=s("label",{class:"small mb-1",for:"district"},"Kecamatan",-1),Ue={class:"col-md-5 col-xs-10 q-my-sm q-mx-md"},Ce=s("label",{class:"small mb-1",for:"village"},"Kelurahan",-1),Qe={class:"col-md-5 col-xs-10 q-my-sm q-mx-md"},Le=s("label",{class:"small mb-1",for:"country"},"Negara",-1),Pe={class:"col-md-5 col-xs-10 q-my-sm q-mx-md"},Fe=s("label",{class:"small mb-1",for:"zip_code"},"Kode Pos",-1),Se={class:"col-md-5 col-xs-10 q-my-sm q-mx-md"},Ne=s("label",{class:"small mb-1",for:"address_one"},"Alamat Lengkap",-1),Ae={class:"col-md-5 col-xs-10 q-my-sm q-mx-md"},Ee=s("label",{class:"small mb-1",for:"address_two"},"Detail Alamat",-1),Ke=s("hr",{class:"q-my-md"},null,-1),ea={__name:"SettingPage",setup(ze){const v=M(),A=j(),p=r(!0),l=r({id:null,avatar:"",username:"",name:"",email:"",phone_number:"",province:"",province_id:null,regency:"",regency_id:null,district:"",district_id:null,village:"",village_id:null,country:"",zip_code:null,address_one:"",address_two:""}),E=async()=>{p.value=!0;try{const a=await V().profile();l.value=a.data.data}catch(a){console.error("Error fetching data:",a)}p.value=!1};k(()=>{E()});const c=r([]),K=async()=>{try{const a=await V().all();c.value=a.data.data}catch(a){console.error("Error fetching data:",a)}};k(()=>{K()});const _=r([]),f=r([]),g=r([]),b=r([]),z=async()=>{try{const a=await H().all();_.value=a.data.provinces.map(e=>({id:e.id,label:e.name,value:e.name})),d.value.provinces=[..._.value],f.value=a.data.regencies.map(e=>({id:e.id,label:e.name,value:e.name})),d.value.regencies=[...f.value],g.value=a.data.districts.map(e=>({id:e.id,label:e.name,value:e.name})),d.value.districts=[...g.value],b.value=a.data.villages.map(e=>({id:e.id,label:e.name,value:e.name})),d.value.villages=[...b.value]}catch(a){console.error("Error fetching data:",a)}p.value=!1};k(()=>{z()});const d=r({provinces:[],regencies:[],districts:[],villages:[]}),h={provinces(a,e){e(()=>{const o=a.toLowerCase();d.value.provinces=_.value.filter(n=>n.value.toLowerCase().includes(o))})},regencies(a,e){e(()=>{const o=a.toLowerCase();d.value.regencies=f.value.filter(n=>n.value.toLowerCase().includes(o))})},districts(a,e){e(()=>{const o=a.toLowerCase();d.value.districts=g.value.filter(n=>n.value.toLowerCase().includes(o))})},villages(a,e){e(()=>{const o=a.toLowerCase();d.value.villages=b.value.filter(n=>n.value.toLowerCase().includes(o))})}},P=r(null),B=async a=>{a.preventDefault();const e=a.target.files[0];if(e){const o=new FileReader;o.onload=()=>{P.value.src=o.result},o.readAsDataURL(e);try{const n=await V().editprofileavatar({avatar:e});l.value.avatar=n.data.data.avatar,v.notify({message:"Foto Profil berhasil diubah",icon:"check",color:"positive"})}catch(n){console.error("Error submitting form:",n),v.notify({message:n.response.data.message||"Foto Profil gagal diubah",icon:"warning",color:"negative"})}}},w=r({username:[a=>!!a||"Username harus diisi",a=>a.length>=6||"Username minimal 6 karakter",a=>a.length<=20||"Username maksimal 20 karakter",a=>typeof a=="string"&&c.value?!c.value.some(e=>e.username.toLowerCase()===a.toLowerCase()&&e.id!==l.value.id)||"Username sudah ada":!0],name:[a=>!!a||"Nama harus diisi",a=>a.length<=50||"Nama maksimal 50 karakter"],email:[a=>!!a||"Email harus diisi",a=>/.+@.+/.test(a)||"Email tidak valid",a=>typeof a=="string"&&c.value?!c.value.some(e=>e.email.toLowerCase()===a.toLowerCase()&&e.id!==l.value.id)||"Email sudah ada":!0]}),y=r(!1),D=I(()=>y.value||!l.value.name||!l.value.email),F=async()=>{y.value=!0;try{l.value.province&&(l.value.province_id=_.value.find(a=>a.label===l.value.province).id),l.value.regency&&(l.value.regency_id=f.value.find(a=>a.label===l.value.regency).id),l.value.district&&(l.value.district_id=g.value.find(a=>a.label===l.value.district).id),l.value.village&&(l.value.village_id=b.value.find(a=>a.label===l.value.village).id),await V().editprofile(l.value),v.notify({message:"Profil berhasil diedit",icon:"check",color:"positive"}),A.back(),setTimeout(()=>{window.location.reload()},100)}catch(a){console.error("Error submitting form:",a),v.notify({message:a.response.data.message||"Profil gagal diedit, Silahkan coba lagi nanti",icon:"warning",color:"negative"})}y.value=!1};return(a,e)=>(U(),C(T,{class:"q-my-xl"},{default:i(()=>[O,p.value?(U(),C(S,{key:0,onSubmit:F},{default:i(()=>[s("div",W,[s("div",X,[t(x,{width:"100%",height:"350px"})]),s("div",Y,[t(x,{width:"100%",height:"350px"})]),s("div",Z,[t(x,{width:"100%",height:"450px"})])]),t(x,{width:"90px",height:"38px",class:"float-right"}),ee]),_:1})):(U(),C(S,{key:1,onSubmit:F},{default:i(()=>[s("div",ae,[s("div",le,[t(L,{style:{height:"100%"}},{default:i(()=>[t(m,{class:"bg-blue-grey-1"},{default:i(()=>[se]),_:1}),t(Q),t(m,{class:"text-center q-pa-md"},{default:i(()=>[t($,{size:"100px",class:"q-my-md"},{default:i(()=>[s("img",{ref_key:"avatar",ref:P,src:G(J)+"/public/avatars/"+l.value.avatar},null,8,oe)]),_:1}),te,t(N,{color:"primary",class:"q-my-md",label:"Unggah Foto baru",onClick:e[0]||(e[0]=o=>a.$refs.avatarInput.click()),"no-caps":""}),s("input",{type:"file",ref:"avatarInput",id:"avatarInput",style:{display:"none"},accept:"image/*",onChange:B},null,544)]),_:1})]),_:1})]),s("div",ie,[t(L,{style:{height:"100%"}},{default:i(()=>[t(m,{class:"bg-blue-grey-1"},{default:i(()=>[de]),_:1}),t(Q),t(m,{class:"q-pa-md"},{default:i(()=>[s("div",ne,[s("div",re,[ue,t(u,{modelValue:l.value.username,"onUpdate:modelValue":e[1]||(e[1]=o=>l.value.username=o),id:"username",label:"Username",rules:w.value.username,outlined:"",dense:"",required:"",autofocus:""},null,8,["modelValue","rules"])]),s("div",me,[ce,t(u,{modelValue:l.value.name,"onUpdate:modelValue":e[2]||(e[2]=o=>l.value.name=o),id:"name",label:"Nama",rules:w.value.name,outlined:"",dense:"",required:""},null,8,["modelValue","rules"])]),s("div",ve,[pe,t(u,{type:"email",modelValue:l.value.email,"onUpdate:modelValue":e[3]||(e[3]=o=>l.value.email=o),id:"email",label:"Email",rules:w.value.email,outlined:"",dense:"",required:""},null,8,["modelValue","rules"])]),s("div",_e,[fe,t(u,{modelValue:l.value.phone_number,"onUpdate:modelValue":e[4]||(e[4]=o=>l.value.phone_number=o),id:"phone_number",label:"Nomor Telepon",mask:"#### - #### - ######",outlined:"",dense:""},null,8,["modelValue"])])])]),_:1})]),_:1})]),s("div",ge,[t(L,null,{default:i(()=>[t(m,{class:"bg-blue-grey-1"},{default:i(()=>[be]),_:1}),t(Q),t(m,{class:"q-pa-md"},{default:i(()=>[s("div",he,[s("div",ye,[xe,t(q,{modelValue:l.value.province,"onUpdate:modelValue":e[5]||(e[5]=o=>l.value.province=o),options:d.value.provinces,onFilter:h.provinces,id:"province",label:"Provinsi","input-debounce":"0","use-input":"","fill-input":"","emit-value":"","hide-selected":"",outlined:"",dense:""},null,8,["modelValue","options","onFilter"])]),s("div",qe,[Ve,t(q,{modelValue:l.value.regency,"onUpdate:modelValue":e[6]||(e[6]=o=>l.value.regency=o),options:d.value.regencies,onFilter:h.regencies,id:"regency",label:"Kabupaten","input-debounce":"0","use-input":"","fill-input":"","emit-value":"","hide-selected":"",outlined:"",dense:""},null,8,["modelValue","options","onFilter"])]),s("div",we,[ke,t(q,{modelValue:l.value.district,"onUpdate:modelValue":e[7]||(e[7]=o=>l.value.district=o),options:d.value.districts,onFilter:h.districts,id:"district",label:"Kecamatan","input-debounce":"0","use-input":"","fill-input":"","emit-value":"","hide-selected":"",outlined:"",dense:""},null,8,["modelValue","options","onFilter"])]),s("div",Ue,[Ce,t(q,{modelValue:l.value.village,"onUpdate:modelValue":e[8]||(e[8]=o=>l.value.village=o),options:d.value.villages,onFilter:h.villages,id:"village",label:"Kelurahan","input-debounce":"0","use-input":"","fill-input":"","emit-value":"","hide-selected":"",outlined:"",dense:""},null,8,["modelValue","options","onFilter"])]),s("div",Qe,[Le,t(u,{modelValue:l.value.country,"onUpdate:modelValue":e[9]||(e[9]=o=>l.value.country=o),id:"country",label:"Negara",outlined:"",dense:""},null,8,["modelValue"])]),s("div",Pe,[Fe,t(u,{type:"number",modelValue:l.value.zip_code,"onUpdate:modelValue":e[10]||(e[10]=o=>l.value.zip_code=o),id:"zip_code",label:"Kode Pos",outlined:"",dense:""},null,8,["modelValue"])]),s("div",Se,[Ne,t(u,{type:"textarea",modelValue:l.value.address_one,"onUpdate:modelValue":e[11]||(e[11]=o=>l.value.address_one=o),id:"address_one",label:"Alamat Lengkap",outlined:"",dense:""},null,8,["modelValue"])]),s("div",Ae,[Ee,t(u,{modelValue:l.value.address_two,"onUpdate:modelValue":e[12]||(e[12]=o=>l.value.address_two=o),id:"address_two",label:"Detail Alamat (Contoh : Dekat pohon besar)",outlined:"",dense:""},null,8,["modelValue"])])])]),_:1})]),_:1})])]),t(N,{type:"submit",label:"Simpan",color:"primary",class:"float-right",loading:y.value,disable:D.value},{loading:i(()=>[t(R)]),_:1},8,["loading","disable"]),Ke]),_:1}))]),_:1}))}};export{ea as default};
