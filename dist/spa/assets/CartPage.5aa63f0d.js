import{aW as T,aR as j,u as A,r as u,aS as F,d as G,w as Q,k as H,m as o,x as l,z as e,q as c,aX as V,aE as b,aD as x,C as W,D as i,p as C,Q as I,B as $,v as z,aQ as J,aY as K,aZ as L}from"./index.3411a222.js";import{Q as k}from"./QSkeleton.72d58935.js";import{Q as M}from"./QImg.602e0d0f.js";import{Q as O}from"./QSpinnerGears.11fcd29c.js";import{u as X}from"./use-quasar.a53b7e3f.js";import{url as Y}from"./axios.7b547941.js";import{u as f}from"./cart-store.8863e221.js";import{u as Z}from"./transaction-store.4971fc28.js";const d=m=>(K("data-v-63598566"),m=m(),L(),m),ee={class:"q-my-lg"},te={class:"table-container"},ae={class:"responsive-table"},se={class:"table-header"},oe={class:"table-row-header"},le={class:"table-cell-checklist"},ce=d(()=>e("td",{class:"table-cell-header-product"},"Produk",-1)),re=d(()=>e("td",{class:"table-cell"},"Harga Satuan",-1)),de=d(()=>e("td",{class:"table-cell"},"Kuantitas",-1)),ne=d(()=>e("td",{class:"table-cell"},"Total Harga",-1)),ie=d(()=>e("td",{class:"table-cell"},"Aksi",-1)),ue={key:0,class:"table-body"},me={key:1,class:"table-body"},pe={key:0},_e={class:"table-cell-checklist"},he={class:"table-cell-product"},ye={class:"row justify-center"},ve={class:"col-10"},ge={class:"component-products"},be={class:"products-title text-h6 q-mt-sm q-ml-sm"},xe={class:"products-price text-body2 q-ml-sm",style:{color:"#ff7158"}},ke={class:"table-cell"},fe={class:"table-cell"},qe={class:"table-cell text-primary text-bold"},we={class:"table-cell text-primary text-bold"},Se={key:1,class:"text-subtitle1 text-center text-grey-7 q-mt-md"},Qe=d(()=>e("div",{class:"text-h6 text-bold q-mt-md"},"Informasi Pembayaran",-1)),Ve={class:"row q-my-sm"},Ce={class:"col-sm-5 col-xs-8 q-my-sm"},Ie=d(()=>e("div",{class:"text-body1 text-grey-7 text-bold"},"Produk yang dipilih",-1)),Ee={class:"col-sm-3 col-xs-8 q-my-sm"},Be=d(()=>e("div",{class:"text-body1 text-grey-7 text-bold"},"Jumlah yang dibeli",-1)),Pe={class:"col-sm-2 col-xs-8 q-my-sm"},De=d(()=>e("div",{class:"text-body1 text-grey-7 text-bold"},"Total Harga",-1)),Ue={class:"text-body1 text-red text-bold"},Ne={class:"col-sm-2 col-xs-8 q-my-sm"},Re={key:0,style:{"margin-bottom":"280px"}},Te={__name:"CartPage",setup(m){const p=X(),E=j(),B=A(),v=u(!0),r=u([]),q=async()=>{v.value=!0;try{const t=await f().getByUser();r.value=t.data.data,r.value.forEach(s=>{s.cartselected=!1})}catch(t){console.error("Error fetching data:",t)}v.value=!1};F(()=>{E.name=="home.cart"&&q()});const n=u([]),P=t=>{r.value.forEach(s=>{s.cartselected=t})},D=()=>{n.value=r.value.filter(t=>t.cartselected),console.log(n.value)},g=G(()=>r.value.filter(t=>t.cartselected).reduce((t,s)=>t+s.product.price*s.quantity,0)),U=async t=>{try{await f().edit(t)}catch(s){console.error("Error updating cart quantity:",s)}};Q(r,t=>{t.forEach(s=>{Q(()=>s.quantity,S=>{U(s)})})},{deep:!0});const N=t=>{p.dialog({title:"WARNING!!!",message:"Apakah anda yakin?",cancel:!0,persistent:!0}).onOk(async()=>{try{await f().delete(t),p.notify({message:"Berhasil menghapus produk dari keranjang",icon:"check",color:"positive"}),q()}catch(s){console.error("Error submitting form:",s),p.notify({message:s.response.data.message||"Gagal menghapus produk dari keranjang",icon:"warning",color:"negative"})}})},w=u({product_price:g,total_price:g,transactiondetail:[]}),_=u(!1),R=async()=>{_.value=!0;try{w.value.transactiondetail=n.value.map(s=>({product_id:s.product_id,price:s.product.price,quantity:s.quantity}));const t=await Z().create(w.value);B.push({name:"home.transaction",params:{invoice:t.data.data.invoice}})}catch(t){console.error("Error submitting form:",t),p.notify({message:t.response.data.message?"Silahkan pilih produk yang akan dibeli":"Produk gagal dibuat, Silahkan coba lagi nanti",icon:"warning",color:"negative"})}_.value=!1},h=t=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(t);return(t,s)=>{const S=H("router-link");return o(),l("div",ee,[e("div",te,[e("table",ae,[e("th",se,[e("div",oe,[e("td",le,[c(V,{modelValue:n.value,"onUpdate:modelValue":[s[0]||(s[0]=a=>n.value=a),P]},null,8,["modelValue"])]),ce,re,de,ne,ie])]),v.value?(o(),l("tr",ue,[c(k,{height:"180px",class:"q-my-md"}),c(k,{height:"180px",class:"q-my-md"}),c(k,{height:"180px",class:"q-my-md"})])):(o(),l("tr",me,[r.value&&r.value.length>0?(o(),l("div",pe,[(o(!0),l(b,null,x(r.value,a=>(o(),l("div",{class:"table-row q-my-md",key:a.id},[e("td",_e,[c(V,{modelValue:a.cartselected,"onUpdate:modelValue":[y=>a.cartselected=y,D],value:a.id},null,8,["modelValue","onUpdate:modelValue","value"])]),e("td",he,[e("div",ye,[e("div",ve,[c(S,{to:{name:"home.showproduct",params:{slug:a.product.slug}},class:"products-link"},{default:C(()=>[e("div",ge,[c(M,{src:z(Y)+"/public/products/"+a.product.photos[0].photo,ratio:16/9,class:"products-image"},null,8,["src"])]),e("div",be,i(a.product.name),1),e("div",xe,i(h(a.product.price)),1)]),_:2},1032,["to"])])])]),e("td",ke,i(h(a.product.price)),1),e("td",fe,[c(J,{type:"number",modelValue:a.quantity,"onUpdate:modelValue":y=>a.quantity=y,modelModifiers:{number:!0},"input-class":"text-center",dense:"",borderless:""},null,8,["modelValue","onUpdate:modelValue"])]),e("td",qe,i(h(a.product.price*a.quantity)),1),e("td",we,[c(I,{color:"red",icon:"delete",onClick:y=>N(a.id)},null,8,["onClick"])])]))),128))])):(o(),l("div",Se,"Tidak ada produk di keranjang."))]))])]),c(W,{class:"q-my-lg"}),Qe,e("div",Ve,[e("div",Ce,[Ie,(o(!0),l(b,null,x(n.value,a=>(o(),l("div",{key:a.id,class:"text-subtitle2"},"- "+i(a.product.name),1))),128))]),e("div",Ee,[Be,(o(!0),l(b,null,x(n.value,a=>(o(),l("div",{key:a.id,class:"text-subtitle2"},"x "+i(a.quantity),1))),128))]),e("div",Pe,[De,e("div",Ue,i(h(g.value)),1)]),e("div",Ne,[c(I,{color:"primary",label:"Beli Sekarang",onClick:R,loading:_.value,disable:_.value,"no-caps":""},{loading:C(()=>[c(O)]),_:1},8,["loading","disable"])])]),r.value.length<3?(o(),l("div",Re)):$("",!0)])}}};var Je=T(Te,[["__scopeId","data-v-63598566"]]);export{Je as default};
